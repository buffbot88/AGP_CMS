@page
@model LegendaryCMS.Pages.WebMarket.DashboardModel
@{
    ViewData["Title"] = "Web Hosting Dashboard";
}

<div class="container mt-5">
    @if (Model.ErrorMessage != null)
    {
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            @Model.ErrorMessage
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }

    @if (Model.SuccessMessage != null)
    {
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            @Model.SuccessMessage
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }

    @if (!Model.IsAuthenticated)
    {
        <div class="alert alert-warning" role="alert">
            <h5 class="alert-heading">Authentication Required</h5>
            <p>You need to be logged in to access your dashboard.</p>
            <hr>
            <a href="/Login" class="btn btn-warning">Login</a>
        </div>
    }
    else if (Model.Account == null)
    {
        <div class="alert alert-info" role="alert">
            <h5 class="alert-heading">No Hosting Account</h5>
            <p>You don't have a web hosting account yet.</p>
            <hr>
            <a href="/WebMarket" class="btn btn-primary">View Packages</a>
        </div>
    }
    else
    {
        <div class="row mb-4">
            <div class="col-md-12">
                <h1 class="display-5">@Model.Account.SiteName</h1>
                <p class="lead">Manage your web hosting account</p>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-md-4 mb-3">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h5 class="card-title"><i class="bi bi-globe"></i> Website URL</h5>
                        <p class="card-text">
                            <a href="/user_websites/@Model.Account.SiteSlug" target="_blank" class="btn btn-link p-0">
                                http://agpstudios.org/@Model.Account.SiteSlug
                            </a>
                        </p>
                        <small class="text-muted">Click to view your live website</small>
                    </div>
                </div>
            </div>

            <div class="col-md-4 mb-3">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h5 class="card-title"><i class="bi bi-box"></i> Package</h5>
                        <p class="card-text">
                            @if (Model.Package != null)
                            {
                                <strong>@Model.Package.Name</strong><br />
                                <small>$@Model.Package.Price.ToString("0.00")/month</small>
                            }
                        </p>
                    </div>
                </div>
            </div>

            <div class="col-md-4 mb-3">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h5 class="card-title"><i class="bi bi-shield-check"></i> Status</h5>
                        <p class="card-text">
                            <span class="badge @(Model.Account.Status == "active" ? "bg-success" : "bg-warning")">
                                @Model.Account.Status.ToUpper()
                            </span>
                        </p>
                        <small class="text-muted">Created: @Model.Account.CreatedAt.ToString("MMM d, yyyy")</small>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-md-12">
                <div class="card shadow">
                    <div class="card-header bg-primary text-white">
                        <h4 class="mb-0"><i class="bi bi-hdd-network"></i> FTP Connection Details</h4>
                    </div>
                    <div class="card-body">
                        @if (Model.FTPInfo != null && Model.Account.FtpEnabled)
                        {
                            <div class="row">
                                <div class="col-md-6">
                                    <dl class="row">
                                        <dt class="col-sm-4">Host:</dt>
                                        <dd class="col-sm-8"><code>@Model.FTPInfo.Host</code></dd>

                                        <dt class="col-sm-4">Port:</dt>
                                        <dd class="col-sm-8"><code>@Model.FTPInfo.Port</code></dd>

                                        <dt class="col-sm-4">Username:</dt>
                                        <dd class="col-sm-8"><code>@Model.FTPInfo.Username</code></dd>

                                        <dt class="col-sm-4">Password:</dt>
                                        <dd class="col-sm-8"><code>Your FTP password</code></dd>
                                    </dl>
                                </div>
                                <div class="col-md-6">
                                    <h5>How to Connect:</h5>
                                    <ol>
                                        <li>Open your FTP client (FileZilla, WinSCP, etc.)</li>
                                        <li>Enter the connection details shown on the left</li>
                                        <li>Upload your files to the <code>wwwroot</code> folder</li>
                                        <li>Your changes will be live immediately</li>
                                    </ol>
                                    <p class="mb-0">
                                        <a href="https://filezilla-project.org/" target="_blank" class="btn btn-sm btn-outline-primary">
                                            Download FileZilla (Free FTP Client)
                                        </a>
                                    </p>
                                </div>
                            </div>
                        }
                        else
                        {
                            <div class="alert alert-warning mb-0">
                                FTP access is currently disabled for your account. Contact support to enable it.
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-md-12">
                <div class="card shadow">
                    <div class="card-header">
                        <h4 class="mb-0"><i class="bi bi-list-check"></i> Your Features</h4>
                    </div>
                    <div class="card-body">
                        @if (Model.Package != null && Model.Package.Features.Length > 0)
                        {
                            <div class="row">
                                @foreach (var feature in Model.Package.Features)
                                {
                                    <div class="col-md-6 col-lg-3 mb-3">
                                        <div class="feature-box p-3 border rounded">
                                            <i class="bi bi-check-circle-fill text-success"></i>
                                            <strong>@GetFeatureDisplayName(feature)</strong>
                                        </div>
                                    </div>
                                }
                            </div>
                        }
                        else
                        {
                            <p class="mb-0">No features available.</p>
                        }
                    </div>
                </div>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-md-12">
                <div class="card shadow">
                    <div class="card-header">
                        <h4 class="mb-0"><i class="bi bi-folder"></i> Directory Structure</h4>
                    </div>
                    <div class="card-body">
                        <p>Your files are organized in the following structure:</p>
                        <pre class="bg-light p-3 rounded"><code>@Model.Account.SiteSlug/
├── wwwroot/          ← Upload your website files here
│   └── index.html    ← Your homepage
├── data/             ← Database and data files
├── uploads/          ← User uploaded content
├── logs/             ← System logs
└── README.md         ← Site documentation</code></pre>
                        <div class="alert alert-info mb-0">
                            <strong>Tip:</strong> Upload all your website files (HTML, CSS, JS, images) to the <code>wwwroot</code> folder via FTP.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-md-12">
                <div class="card shadow">
                    <div class="card-header">
                        <h4 class="mb-0"><i class="bi bi-info-circle"></i> Account Information</h4>
                    </div>
                    <div class="card-body">
                        <dl class="row mb-0">
                            <dt class="col-sm-3">Account ID:</dt>
                            <dd class="col-sm-9">@Model.Account.Id</dd>

                            <dt class="col-sm-3">Site Name:</dt>
                            <dd class="col-sm-9">@Model.Account.SiteName</dd>

                            <dt class="col-sm-3">Site Slug:</dt>
                            <dd class="col-sm-9">@Model.Account.SiteSlug</dd>

                            <dt class="col-sm-3">Email:</dt>
                            <dd class="col-sm-9">@Model.Account.Email</dd>

                            <dt class="col-sm-3">Created:</dt>
                            <dd class="col-sm-9">@Model.Account.CreatedAt.ToString("MMMM d, yyyy 'at' h:mm tt")</dd>

                            <dt class="col-sm-3">Last Updated:</dt>
                            <dd class="col-sm-9">@Model.Account.UpdatedAt.ToString("MMMM d, yyyy 'at' h:mm tt")</dd>
                        </dl>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mb-5">
            <div class="col-md-12">
                <div class="card shadow border-warning">
                    <div class="card-header bg-warning">
                        <h4 class="mb-0"><i class="bi bi-question-circle"></i> Need Help?</h4>
                    </div>
                    <div class="card-body">
                        <p>If you need assistance with your web hosting account, please contact our support team.</p>
                        <p class="mb-0">
                            <a href="mailto:support@agpstudios.org" class="btn btn-warning">Contact Support</a>
                            <a href="/WebMarket" class="btn btn-outline-secondary">View Other Packages</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    }
</div>

@functions {
    private string GetFeatureDisplayName(string feature)
    {
        return feature switch
        {
            "forum" => "Discussion Forums",
            "blog" => "Blog System",
            "website" => "Website Hosting",
            "downloads" => "File Downloads",
            _ => feature
        };
    }
}

<style>
    .feature-box {
        text-align: center;
        min-height: 80px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }
    .feature-box i {
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
    }
</style>
